一、服务路由
    分布式服务框架上线运行时都是集群组网，集群中存在某个服务的多实例部署，消费者如何从服务列表中选择合适的服务提供者进行调用，需要服务路由

1、基于服务注册中心的订阅发布
    服务消费者和服务提供者通过注册中心（Zookeeper）提供的sdk与注册中心建立长连接
    服务提供者将需要发布的服务地址信息和属性列表写入注册中心。
    服务消费者根据本地引用的接口名，从服务注册中心获取服务提供者列表，缓存到本地。

    由于消费者可能先于服务提供者启动，或者系统运行过程中新增服务提供者，或者某个服务提供者断掉，就会导致注册中心发生服务提供者地址改变，注册中心检测到服务
    提供者列表变更后，将变更内容主动推送给服务消费者，消费者根据变更列表，动态刷新本地缓存的服务提供者地址

2、负载均衡
   随机、轮询等
   服务调用时： 保证能力强的服务提供者接收更多的消息
   一致性哈希：

3、本地路由优先策略 ：
   消费者和提供者可能被部署到同一机器，服务路由时优先选择本机的服务提供者，找不到时在发起远程调用。

4、路由规则：
   条件路由规则 ：可以用于解决垮机房调用
       通过ip条件表达式进行黑白名单控制
       流量控制：只暴露部分服务提供者，防止整个集群服务被冲垮
       读写分离：
       前后台分离

5、多机房路由 ： 垮机房服务调用会带来时延增加，网络故障概率变大等问题
   为了能够相互发现对方的服务，不同机房会共用同一个服务注册中心集群，不同机房的消费者都会看到两个机房的服务
   如果解决垮机房服务调用，要利用条件路由规则：
        在原有的负载均衡策略上，配置条件路由策略，由于不同机房的网段不同，可以网段条件匹配实现地址过滤。
        具体方式：app = web*,consumerIP=192.168.1.* -> providerIP = 192.168.1.* 对于机房A中所有web前台应用，只访问本机房内部的服务提供者，不垮机房调用。



